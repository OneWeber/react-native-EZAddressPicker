{"version":3,"sources":["../../../../src/commands/server/middleware/getSecurityHeadersMiddleware.ts"],"names":["getSecurityHeadersMiddleware","req","res","next","address","client","server","headers","origin","port","Error","setHeader"],"mappings":";;;;;;;AAAA;;;;;;AAQe,SAASA,4BAAT,CACbC,GADa,EAEbC,GAFa,EAGbC,IAHa,EAIb;AACA;AACA,QAAMC,OAAO,GAAGH,GAAG,CAACI,MAAJ,CAAWC,MAAX,CAAkBF,OAAlB,EAAhB,CAFA,CAIA;;AACA,MACEH,GAAG,CAACM,OAAJ,CAAYC,MAAZ,IACAP,GAAG,CAACM,OAAJ,CAAYC,MAAZ,KAAwB,oBAAmBJ,OAAO,CAACK,IAAK,EAF1D,EAGE;AACAN,IAAAA,IAAI,CACF,IAAIO,KAAJ,CACE,+BACET,GAAG,CAACM,OAAJ,CAAYC,MADd,GAEE,uGAHJ,CADE,CAAJ;AAOA;AACD,GAjBD,CAmBA;;;AACAN,EAAAA,GAAG,CAACS,SAAJ,CAAc,wBAAd,EAAwC,SAAxC;AAEAR,EAAAA,IAAI;AACL","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport http from 'http';\n\nexport default function getSecurityHeadersMiddleware(\n  req: http.IncomingMessage,\n  res: http.ServerResponse,\n  next: (err?: any) => void,\n) {\n  // @ts-ignore Property 'client' does not exist on type 'IncomingMessage', verify\n  const address = req.client.server.address();\n\n  // Block any cross origin request.\n  if (\n    req.headers.origin &&\n    req.headers.origin !== `http://localhost:${address.port}`\n  ) {\n    next(\n      new Error(\n        'Unauthorized request from ' +\n          req.headers.origin +\n          '. This may happen because of a conflicting browser extension. Please try to disable it and try again.',\n      ),\n    );\n    return;\n  }\n\n  // Block MIME-type sniffing.\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n\n  next();\n}\n"]}